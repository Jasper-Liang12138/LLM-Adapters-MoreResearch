# Qwen-32B 训练脚本对比说明

## 📁 文件列表

### 课程学习版本
- **训练脚本**: `finetune_npu_deepspeed.py`
- **启动脚本**: `launch_qwen32b_cloud.sh`
- **适用场景**: 数据集包含 `difficulty` 字段（explain/reasoning/topology）

### 标准微调版本
- **训练脚本**: `finetune_npu_deepspeed_standard.py`
- **启动脚本**: `launch_qwen32b_standard.sh`
- **适用场景**: 标准数据集，无需课程学习

## 🔍 主要区别

| 特性 | 课程学习版本 | 标准版本 |
|------|------------|---------|
| **数据要求** | 需要 `difficulty` 字段 | 标准格式即可 |
| **训练策略** | 动态难度采样 | 标准随机采样 |
| **训练循环** | 每个 epoch 重建数据集 | 标准训练循环 |
| **参数** | `--use_curriculum`, `--curriculum_seed` | 无额外参数 |
| **代码复杂度** | 较高 | 较低 |
| **适用场景** | 有明确难度分级的数据 | 通用数据集 |

## 📊 数据格式对比

### 课程学习版本数据格式
```json
[
  {
    "instruction": "问题",
    "input": "可选输入",
    "output": "答案",
    "difficulty": "explain"  // 必需：explain/reasoning/topology
  }
]
```

### 标准版本数据格式
```json
[
  {
    "instruction": "问题",
    "input": "可选输入",
    "output": "答案"
  }
]
```

## 🚀 使用建议

### 选择课程学习版本的情况：
1. ✅ 数据集有明确的难度分级
2. ✅ 希望从简单到复杂渐进式训练
3. ✅ 数据集包含不同类型的任务（解释、推理、拓扑等）
4. ✅ 追求更好的收敛速度和泛化能力

### 选择标准版本的情况：
1. ✅ 数据集没有难度标注
2. ✅ 数据集难度分布均匀
3. ✅ 希望简单直接的训练流程
4. ✅ 不需要特殊的训练策略

## 📝 使用示例

### 课程学习版本
```bash
# 确保数据集包含 difficulty 字段
bash launch_qwen32b_cloud.sh
```

### 标准版本
```bash
# 标准数据集即可
bash launch_qwen32b_standard.sh
```

## ⚙️ 性能对比

| 指标 | 课程学习版本 | 标准版本 |
|------|------------|---------|
| **训练速度** | 略慢（需要重建数据集） | 标准速度 |
| **收敛速度** | 通常更快 | 标准 |
| **最终性能** | 可能更好 | 标准 |
| **内存占用** | 相同 | 相同 |
| **代码维护** | 较复杂 | 简单 |

## 🔄 版本切换

如果您的数据集：
- **有 difficulty 字段** → 使用课程学习版本
- **无 difficulty 字段** → 使用标准版本
- **不确定** → 先用标准版本测试

## 💡 提示

1. 两个版本的 DeepSpeed 配置完全相同
2. 两个版本都支持多节点分布式训练
3. 课程学习版本在检测不到 difficulty 字段时会自动回退到标准训练
4. 可以根据实际需求随时切换版本

## 📞 技术支持

如有问题，请检查：
1. 数据集格式是否正确
2. 环境变量是否配置
3. DeepSpeed 是否正确安装
4. 日志文件中的详细错误信息
